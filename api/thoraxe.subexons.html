

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>thoraxe.subexons package &mdash; ThorAxe 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="thoraxe.transcript_info package" href="thoraxe.transcript_info.html" />
    <link rel="prev" title="thoraxe package" href="thoraxe.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ThorAxe
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../programs/programs.html">Command line programs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output.html">Output description</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Module API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="thoraxe.html">thoraxe package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="thoraxe.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">thoraxe.subexons package</a></li>
<li class="toctree-l4"><a class="reference internal" href="thoraxe.transcript_info.html">thoraxe.transcript_info package</a></li>
<li class="toctree-l4"><a class="reference internal" href="thoraxe.transcript_query.html">thoraxe.transcript_query package</a></li>
<li class="toctree-l4"><a class="reference internal" href="thoraxe.utils.html">thoraxe.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="thoraxe.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="thoraxe.html#module-thoraxe.thoraxe">thoraxe.thoraxe module</a></li>
<li class="toctree-l3"><a class="reference internal" href="thoraxe.html#module-thoraxe">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ThorAxe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">thoraxe</a> &raquo;</li>
        
          <li><a href="thoraxe.html">thoraxe package</a> &raquo;</li>
        
      <li>thoraxe.subexons package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/thoraxe.subexons.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="thoraxe-subexons-package">
<h1>thoraxe.subexons package<a class="headerlink" href="#thoraxe-subexons-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-thoraxe.subexons.alignment">
<span id="thoraxe-subexons-alignment-module"></span><h2>thoraxe.subexons.alignment module<a class="headerlink" href="#module-thoraxe.subexons.alignment" title="Permalink to this headline">¶</a></h2>
<p>alignment: Module to create the subexon MSA with Clustal Omega.</p>
<dl class="class">
<dt id="thoraxe.subexons.alignment.ColCluster">
<em class="property">class </em><code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">ColCluster</code><span class="sig-paren">(</span><em class="sig-param">patterns</em>, <em class="sig-param">consensus</em>, <em class="sig-param">start</em>, <em class="sig-param">end</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.ColCluster" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="thoraxe.subexons.alignment.ColPattern">
<em class="property">class </em><code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">ColPattern</code><span class="sig-paren">(</span><em class="sig-param">pattern</em>, <em class="sig-param">start</em>, <em class="sig-param">end</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.ColPattern" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="thoraxe.subexons.alignment.ColPattern.end">
<em class="property">property </em><code class="sig-name descname">end</code><a class="headerlink" href="#thoraxe.subexons.alignment.ColPattern.end" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="method">
<dt id="thoraxe.subexons.alignment.ColPattern.pattern">
<em class="property">property </em><code class="sig-name descname">pattern</code><a class="headerlink" href="#thoraxe.subexons.alignment.ColPattern.pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="thoraxe.subexons.alignment.ColPattern.start">
<em class="property">property </em><code class="sig-name descname">start</code><a class="headerlink" href="#thoraxe.subexons.alignment.ColPattern.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.column_clusters">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">column_clusters</code><span class="sig-paren">(</span><em class="sig-param">colpatterns</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.column_clusters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a ColCluster liste from a ColPattern list.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.column_patterns">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">column_patterns</code><span class="sig-paren">(</span><em class="sig-param">msa_matrix</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.column_patterns" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a ColPattern list from the msa_matrix.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.create_chimeric_sequences">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">create_chimeric_sequences</code><span class="sig-paren">(</span><em class="sig-param">subexon_table</em>, <em class="sig-param">subexon_matrix</em>, <em class="sig-param">connected_subexons</em>, <em class="sig-param">padding='XXXXXXXXXX'</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.create_chimeric_sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Create chimeric sequence for Clustal Omega.</p>
<p>It returns a Dict from ‘GeneID’ to a tuple with the chimeric
sequence and a Dict from ‘SubexonIndex’ to …</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.create_msa_matrix">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">create_msa_matrix</code><span class="sig-paren">(</span><em class="sig-param">chimerics</em>, <em class="sig-param">msa</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.create_msa_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a msa from chimerics to a matrix.</p>
<p>Each cell has the subexon number (Index) or nan for gaps and padding.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.create_subexon_matrix">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">create_subexon_matrix</code><span class="sig-paren">(</span><em class="sig-param">subexon_table</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.create_subexon_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a binary matrix showing subexon presence in transcripts.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.delete_subexons">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">delete_subexons</code><span class="sig-paren">(</span><em class="sig-param">subexon_df</em>, <em class="sig-param">chimerics</em>, <em class="sig-param">msa</em>, <em class="sig-param">cutoff=30.0</em>, <em class="sig-param">min_col_number=4</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.delete_subexons" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the list of ‘SubexonIDCluster’ to delete from ‘Cluster’.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.gene2species">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">gene2species</code><span class="sig-paren">(</span><em class="sig-param">transcript_data</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.gene2species" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the a dict from ‘GeneID’ to ‘Species’.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.get_gene_ids">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">get_gene_ids</code><span class="sig-paren">(</span><em class="sig-param">msa</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.get_gene_ids" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a biopython MSA and return a list with the gene (sequence) ids.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.impute_missing_orthologous_exon_group">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">impute_missing_orthologous_exon_group</code><span class="sig-paren">(</span><em class="sig-param">table</em>, <em class="sig-param">column='HomologousExons'</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.impute_missing_orthologous_exon_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace column values that do not conform to the naming by 0_number.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.msa2sequences">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">msa2sequences</code><span class="sig-paren">(</span><em class="sig-param">msa</em>, <em class="sig-param">gene_ids</em>, <em class="sig-param">padding</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.msa2sequences" title="Permalink to this definition">¶</a></dt>
<dd><p>Return str sequences from msa.</p>
<p>It also checks gene_ids and replaces padding by gaps.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.msa_matrices">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">msa_matrices</code><span class="sig-paren">(</span><em class="sig-param">subexon_df</em>, <em class="sig-param">chimerics</em>, <em class="sig-param">msa</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.msa_matrices" title="Permalink to this definition">¶</a></dt>
<dd><p>Return msa (residues) and subexon id cluster matrices from msa.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.read_msa_fasta">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">read_msa_fasta</code><span class="sig-paren">(</span><em class="sig-param">msa_file</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.read_msa_fasta" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a BioPython’s alignment object from the fasta msa_file.</p>
<p>Return None if the file is empty.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.run_aligner">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">run_aligner</code><span class="sig-paren">(</span><em class="sig-param">chimerics</em>, <em class="sig-param">output_path='alignment.fasta'</em>, <em class="sig-param">aligner='clustalo'</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.run_aligner" title="Permalink to this definition">¶</a></dt>
<dd><p>Run Clustal Omega in the chimeric sequences and return the output file.</p>
<p>You can pass arguments using aligner (default: ‘clustalo’), e.g:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aligner</span><span class="o">=</span><span class="s1">&#39;clustalo --threads=4&#39;</span>
</pre></div>
</div>
<p>You need Clustal Omega installed to run this function. You can install it
from: <a class="reference external" href="http://www.clustal.org/omega/">http://www.clustal.org/omega/</a></p>
<p>If you are using Windows 10 and you have installed Clustal Omega in
Ubuntu using the ‘Windows Subsystem for Linux’, you can try with the
following options:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aligner</span><span class="o">=</span><span class="s1">&#39;ubuntu.exe -c clustalo&#39;</span>
<span class="n">aligner</span><span class="o">=</span><span class="s1">&#39;bash.exe -c clustalo&#39;</span>
<span class="n">aligner</span><span class="o">=</span><span class="s1">&#39;wsl.exe clustalo&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.save_homologous_subexons">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">save_homologous_subexons</code><span class="sig-paren">(</span><em class="sig-param">subexon_df</em>, <em class="sig-param">sequences</em>, <em class="sig-param">gene_ids</em>, <em class="sig-param">colclusters</em>, <em class="sig-param">output_folder</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.save_homologous_subexons" title="Permalink to this definition">¶</a></dt>
<dd><p>It saves the information about homologous exons.</p>
<p>It takes a list of sequences, like the one returned by msa2sequences.
Return subexon_df with the homologous subexon information.
For each homologous subexon saves a fasta MSA in the output_folder.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.sort_species">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">sort_species</code><span class="sig-paren">(</span><em class="sig-param">chimerics</em>, <em class="sig-param">gene2sp</em>, <em class="sig-param">species_list=None</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.sort_species" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort chimerics using the gene2species output and the species_list.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.alignment.subexon_connectivity">
<code class="sig-prename descclassname">thoraxe.subexons.alignment.</code><code class="sig-name descname">subexon_connectivity</code><span class="sig-paren">(</span><em class="sig-param">subexon_table</em>, <em class="sig-param">id_column='SubexonIDCluster'</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.alignment.subexon_connectivity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a set of connected subexon tuples.</p>
<p>Each tuple has two elements, ‘SubexonIDCluster’ (directed) pairs.
The first subexon appears before of the second in at least one transcript.</p>
</dd></dl>

</div>
<div class="section" id="module-thoraxe.subexons.graph">
<span id="thoraxe-subexons-graph-module"></span><h2>thoraxe.subexons.graph module<a class="headerlink" href="#module-thoraxe.subexons.graph" title="Permalink to this headline">¶</a></h2>
<p>graph: Functions to store the splice graph with conservation information.</p>
<dl class="function">
<dt id="thoraxe.subexons.graph.nodes_and_edges2genes">
<code class="sig-prename descclassname">thoraxe.subexons.graph.</code><code class="sig-name descname">nodes_and_edges2genes</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.graph.nodes_and_edges2genes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return two dictionaries, ones from nodes and other from edges to genes.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.graph.splice_graph_gml">
<code class="sig-prename descclassname">thoraxe.subexons.graph.</code><code class="sig-name descname">splice_graph_gml</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">node2genes</em>, <em class="sig-param">edge2genes</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.graph.splice_graph_gml" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the splice graph in GML (Graph Modelling Language) format.</p>
<p>It stores the conservation level information for nodes and edges, where
conservation is the fraction of species that has that particular feature.</p>
</dd></dl>

</div>
<div class="section" id="module-thoraxe.subexons.phylosofs">
<span id="thoraxe-subexons-phylosofs-module"></span><h2>thoraxe.subexons.phylosofs module<a class="headerlink" href="#module-thoraxe.subexons.phylosofs" title="Permalink to this headline">¶</a></h2>
<p>phylosofs: Functions to generate PhyloSofS input.</p>
<dl class="function">
<dt id="thoraxe.subexons.phylosofs.get_exon2char">
<code class="sig-prename descclassname">thoraxe.subexons.phylosofs.</code><code class="sig-name descname">get_exon2char</code><span class="sig-paren">(</span><em class="sig-param">exons</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.phylosofs.get_exon2char" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary from orthologous exon group to a single character.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">get_exon2char</span><span class="p">([</span><span class="s1">&#39;1_0/1_1&#39;</span><span class="p">,</span> <span class="s1">&#39;2_0&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[&#39;1_0&#39;, &#39;1_1&#39;, &#39;2_0&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="n">exon</span><span class="p">]</span> <span class="k">for</span> <span class="n">exon</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">result</span><span class="p">)]</span>
<span class="go">[&#39;%&#39;, &#39;(&#39;, &#39;)&#39;]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.phylosofs.get_transcript2phylosofs">
<code class="sig-prename descclassname">thoraxe.subexons.phylosofs.</code><code class="sig-name descname">get_transcript2phylosofs</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">exon2char</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.phylosofs.get_transcript2phylosofs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary from transcript id to its phylosofs representation.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.phylosofs.phylosofs_inputs">
<code class="sig-prename descclassname">thoraxe.subexons.phylosofs.</code><code class="sig-name descname">phylosofs_inputs</code><span class="sig-paren">(</span><em class="sig-param">exon_data</em>, <em class="sig-param">ensembl_folder</em>, <em class="sig-param">output_folder</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.phylosofs.phylosofs_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the input files needed for running PhyloSofS in a phylosofs folder.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.phylosofs.prune_tree">
<code class="sig-prename descclassname">thoraxe.subexons.phylosofs.</code><code class="sig-name descname">prune_tree</code><span class="sig-paren">(</span><em class="sig-param">input_tree</em>, <em class="sig-param">output_tree</em>, <em class="sig-param">exontable_file</em>, <em class="sig-param">used_genes</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.phylosofs.prune_tree" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete unused proteins from the Ensembl gene tree.</p>
<p>The function reads the Newick tree from input_tree and stores the pruned
tree in output_tree and returning the output_tree path. If an
error occurs, the function does not save the tree and raises an Exception.</p>
<p>In the tree, each protein is identified by their ensembl translation id.
For each gene, Ensembl uses the longest translated transcript sequence.</p>
<p>The exontable_file downloaded from Ensembl with transcript_query is needed
for getting the mapping between translation and gene ids of the used_genes.</p>
</dd></dl>

</div>
<div class="section" id="module-thoraxe.subexons.plot">
<span id="thoraxe-subexons-plot-module"></span><h2>thoraxe.subexons.plot module<a class="headerlink" href="#module-thoraxe.subexons.plot" title="Permalink to this headline">¶</a></h2>
<p>plot: Generate js data for plotting the MSA matrix using plotly.</p>
<dl class="function">
<dt id="thoraxe.subexons.plot.create_python_structure">
<code class="sig-prename descclassname">thoraxe.subexons.plot.</code><code class="sig-name descname">create_python_structure</code><span class="sig-paren">(</span><em class="sig-param">cluster2data</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.plot.create_python_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Python structured data to be translated to JavaScript.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.plot.plot_msa_subexons">
<code class="sig-prename descclassname">thoraxe.subexons.plot.</code><code class="sig-name descname">plot_msa_subexons</code><span class="sig-paren">(</span><em class="sig-param">cluster2data</em>, <em class="sig-param">output_folder</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.plot.plot_msa_subexons" title="Permalink to this definition">¶</a></dt>
<dd><p>Save html and js data in the output_folder.</p>
</dd></dl>

</div>
<div class="section" id="module-thoraxe.subexons.rescue">
<span id="thoraxe-subexons-rescue-module"></span><h2>thoraxe.subexons.rescue module<a class="headerlink" href="#module-thoraxe.subexons.rescue" title="Permalink to this headline">¶</a></h2>
<p>Functions for the rescue phase.</p>
<dl class="function">
<dt id="thoraxe.subexons.rescue.modify_subexon_cluster">
<code class="sig-prename descclassname">thoraxe.subexons.rescue.</code><code class="sig-name descname">modify_subexon_cluster</code><span class="sig-paren">(</span><em class="sig-param">subexon_table</em>, <em class="sig-param">subexon2cluster</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.rescue.modify_subexon_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify subexon_table using the mapping in subexon2cluster.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.rescue.subexon_rescue_phase">
<code class="sig-prename descclassname">thoraxe.subexons.rescue.</code><code class="sig-name descname">subexon_rescue_phase</code><span class="sig-paren">(</span><em class="sig-param">subexon_table</em>, <em class="sig-param">minimum_len=4</em>, <em class="sig-param">coverage_cutoff=80.0</em>, <em class="sig-param">percent_identity_cutoff=30.0</em>, <em class="sig-param">gap_open_penalty=10</em>, <em class="sig-param">gap_extend_penalty=1</em>, <em class="sig-param">substitution_matrix=None</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.rescue.subexon_rescue_phase" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the subexon rescue phase.</p>
<p>This function looks the subexons to rescues in the subexon_table by
looking at the ‘Cluster’ numbers that are lower than 0, i.e. -1 means that
the subexon has been cleaned up from ‘Cluster’ 1.
Then, each subexon to rescue is aligned against the subexons in other
‘Cluster’s, different from the original one. If it is nicely aligned
against another cluster, the ‘Cluster’ number is modified in the
subexon_table to match the new proposed ‘Cluster’ and the data relative to
the original pairwise alignment are cleaned up.
This function returns the list of ‘Cluster’s that have been modified.</p>
</dd></dl>

</div>
<div class="section" id="module-thoraxe.subexons.subexons">
<span id="thoraxe-subexons-subexons-module"></span><h2>thoraxe.subexons.subexons module<a class="headerlink" href="#module-thoraxe.subexons.subexons" title="Permalink to this headline">¶</a></h2>
<p>Functions to create the subexon table.</p>
<dl class="class">
<dt id="thoraxe.subexons.subexons.Interval">
<em class="property">class </em><code class="sig-prename descclassname">thoraxe.subexons.subexons.</code><code class="sig-name descname">Interval</code><span class="sig-paren">(</span><em class="sig-param">start</em>, <em class="sig-param">end</em>, <em class="sig-param">components</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.subexons.Interval" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="thoraxe.subexons.subexons.Interval.components">
<em class="property">property </em><code class="sig-name descname">components</code><a class="headerlink" href="#thoraxe.subexons.subexons.Interval.components" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="method">
<dt id="thoraxe.subexons.subexons.Interval.end">
<em class="property">property </em><code class="sig-name descname">end</code><a class="headerlink" href="#thoraxe.subexons.subexons.Interval.end" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="method">
<dt id="thoraxe.subexons.subexons.Interval.start">
<em class="property">property </em><code class="sig-name descname">start</code><a class="headerlink" href="#thoraxe.subexons.subexons.Interval.start" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.subexons.create_subexon_table">
<code class="sig-prename descclassname">thoraxe.subexons.subexons.</code><code class="sig-name descname">create_subexon_table</code><span class="sig-paren">(</span><em class="sig-param">transcript_data</em>, <em class="sig-param">merge_non_redundant=True</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.subexons.create_subexon_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a subexon table.</p>
<p>If merge_non_redundant is True (default), contiguous subexons that
appear together in only one exon are merged/joint. This happens
because subexons are defined using coordinates at the genomic level
to reduce redundancy.
However, some subexons does not have the same protein sequence because
of different reading frames/phases, giving non-redundant subexons at
the protein level.</p>
</dd></dl>

<dl class="function">
<dt id="thoraxe.subexons.subexons.disjoint_intervals">
<code class="sig-prename descclassname">thoraxe.subexons.subexons.</code><code class="sig-name descname">disjoint_intervals</code><span class="sig-paren">(</span><em class="sig-param">starts</em>, <em class="sig-param">ends</em>, <em class="sig-param">ids</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.subexons.disjoint_intervals" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of disjoint intervals.</p>
<p>Produce the set of disjoint intervals from a list of start and end
positions (same chr) and optionally ids.
Empty intervals are reported as well.
!!! The intervals need to be sorted by start and end position before
calling the function and the coordinates should be inclusive.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">disjoint_intervals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">40</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">[Interval(start=1, end=9, components={0}), Interval(start=10, end=19, components={1}), Interval(start=20, end=30, components={1, 2}), Interval(start=31, end=39, components=set()), Interval(start=40, end=50, components={3})]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disjoint_intervals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[Interval(start=1, end=7, components={0, 1}), Interval(start=8, end=9, components={0})]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disjoint_intervals</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="go">[Interval(start=1, end=2, components={0}), Interval(start=3, end=7, components={0, 1}), Interval(start=8, end=9, components={1})]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disjoint_intervals</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">AssertionError</span>: <span class="n">starts should be sorted.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">disjoint_intervals</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">AssertionError</span>: <span class="n">starts, ends and ids should have the same length.</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-thoraxe.subexons.tidy">
<span id="thoraxe-subexons-tidy-module"></span><h2>thoraxe.subexons.tidy module<a class="headerlink" href="#module-thoraxe.subexons.tidy" title="Permalink to this headline">¶</a></h2>
<p>tidy:  Utils for having a tidy CSV table output (denormalized table).</p>
<dl class="function">
<dt id="thoraxe.subexons.tidy.get_tidy_table">
<code class="sig-prename descclassname">thoraxe.subexons.tidy.</code><code class="sig-name descname">get_tidy_table</code><span class="sig-paren">(</span><em class="sig-param">table</em>, <em class="sig-param">gene2species</em><span class="sig-paren">)</span><a class="headerlink" href="#thoraxe.subexons.tidy.get_tidy_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a tidy and denormalized output table.</p>
<p>Takes the final exon table and a dict from gene to species name to save a
csv file with the output table in the outputdir.</p>
</dd></dl>

</div>
<div class="section" id="module-thoraxe.subexons">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-thoraxe.subexons" title="Permalink to this headline">¶</a></h2>
<p>subexons: Module to identify and cut subexons.</p>
<p>This defines functions that take as input the DataFrame output from
transcript_info.read_transcript_info.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="thoraxe.transcript_info.html" class="btn btn-neutral float-right" title="thoraxe.transcript_info package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="thoraxe.html" class="btn btn-neutral float-left" title="thoraxe package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Diego Javier Zea, Hugues Richard &amp; Elodie Laine

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>